<%- include('partials/header') %>

<style>
  body {
    background-image: url("/images/<%= meetup.image %>");
    background-size: cover;
  }
</style>

<form id="meetup-edit" action="/edit" method="POST" class="needs-validation" novalidate></form>

<div class="container">
  <div class="py-5 text-center">
    <h1>Edit Event</h1>
    <h3 class="text-danger"><strong><%= message %></strong></h3>
  </div>

  <div class="row">
    <div class="col-md-8 order-md-1">


      <div class="mb-3">
        <input type="text" name="name" value="<%=meetup.name%>" class="form-control" placeholder="Event Name"
          form="meetup-edit" required>
        <div class="invalid-feedback">
          Valid event name is required.
        </div>
      </div>

      <div class="mb-3">
        <textarea type="text" name="desc" placeholder=" Description" rows="2" form="meetup-edit"
          style="width: 100%; padding:10px;"><%= meetup.desc %></textarea>
      </div>
      <hr>


      <!-- Background Image -->
      <form action="/upload" method="post" enctype="multipart/form-data">
        <div class="input-group mb-3">
          <div class="custom-file">
            <input type="file" name="meetupImage" id="meetupImageInput" class="custom-file-input" accept="image/*">
            <label for="meetupImageInput" class="custom-file-label">Upload an Image</label>

          </div>
          <div class="input-group-append">
            <button id="imageUploadBtn" class="btn btn-primary" type="submit" disabled>Upload</button>
          </div>
        </div>
      </form>
      <script>
        document.querySelector('.custom-file-input').addEventListener('change', function (e) {
          var fileName = document.getElementById("meetupImageInput").files[0].name;
          var nextSibling = e.target.nextElementSibling
          nextSibling.innerText = fileName;
          var uploadBtn = document.getElementById("imageUploadBtn");
          uploadBtn.removeAttribute("disabled");
        });
        // document.getElementById('imageUploadBtn').addEventListener('click', function (e) {
        //   e.preventDefault();
        //   var fileName = document.getElementById("meetupImageInput").files[0].name;
        //   document.body.style.backgroundImage = 'url("/images/'+ filename + '")';
        // });
      </script>



      <!-- Where and When -->
      <div class="mb-3">
        <label for="location">Where?</label>
        <input type="text" name="location" class="form-control" placeholder="1234 Main St" form="meetup-edit"
          value="<%= meetup.location %>">
      </div>

      <div class="mb-3">
        <label for="address2">When?</label>
        <input type="text" class="form-control" name="time" placeholder="March 14 from noon to whenever"
          form="meetup-edit" value="<%= meetup.time %>">
      </div>

      <hr class="mb-4">
      <h4 class="mb-3">Details</h4>


      <hr class="mb-4">
      <button class="btn btn-primary btn-block" type="submit" form="meetup-edit">Save Changes</button>
    </div>



    <!-- Guest List -->
    <div class="col-md-4 order-md-2 mb-4">
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-muted">Guest List</span>
        <span class="badge badge-secondary badge-pill">2</span>
      </h4>
      <ul class="list-group mb-3">
        <li class="list-group-item d-flex justify-content-between lh-condensed">
          <div>
            <h6 class="my-0">Aimee Mann</h6>
          </div>
          <strong class="text-success">&#10004;</strong>
        </li>

        <li class="list-group-item d-flex justify-content-between lh-condensed">
          <div>
            <h6 class="my-0">Jeremy Tronet</h6>
          </div>
          <strong class="text-success">&#10004;</strong>
        </li>


      </ul>

      <form class="card p-2 mb-2" method="POST" action="/addguest">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Guest name">
          <input type="text" class="form-control" placeholder="Guest email">
          <div class="input-group-append">
            <button type="submit" class="btn btn-secondary">Add</button>
          </div>
        </div>
      </form>

      <button class="btn btn-secondary">Invite new guests</button>

    </div>
  </div>
</div>
</form>

<%- include('partials/footer') %>